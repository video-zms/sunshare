### 综合知识体系总结

这个体系的核心目标是将用户输入的**自然、模糊的想法**，转化为AI模型能够**精确、高效执行的结构化指令**。

---

#### **第一层：核心理念 (Core Philosophy)**

1.  **AI是执行者，不是读心者**：AI根据指令权重组合视觉元素，必须明确告知它“什么最重要”。
2.  **结构化 > 堆砌**：一个结构清晰的提示词，远胜于一堆杂乱的关键词。
3.  **从粗到精，逐步限制**：先定义核心画面（主体、环境），再添加风格、光影、镜头等修饰，这是一个“约束”和“细化”的过程。
4.  **动静分离**：文生图的核心是描述一个**静态的“决定性瞬间”**，而图生视频/文生视频的核心是描述一个**动态的“运动过程”**。

---

#### **第二层：通用提示词结构公式 (The Universal Prompt Formula)**

这是所有提示词的基础骨架，融合了三份文档的共同点，并按重要性排序：

**`[1. 主体描述] + [2. 动作/姿态] + [3. 场景/环境] + [4. 风格/媒介] + [5. 光影/色彩] + [6. 构图/镜头] + [7. 质量/技术参数]`**

*   **1. 主体描述 (Subject)**:
    *   **要素**: 年龄、性别、外貌特征、服装（材质>款式>颜色）、数量。
    *   **关键**: 必须具体。例如，“一个20岁亚洲女性，黑长直发，穿白色连衣裙”远好于“一个美女”。
*   **2. 动作/姿态 (Action/Pose)**:
    *   **要素**: 主体正在做什么。例如，“双手叉腰自信微笑”、“低头凝视手中的断刀”。
*   **3. 场景/环境 (Environment)**:
    *   **要素**: 三层结构：大环境（城市/森林） -> 具体场景（街道/咖啡店） -> 细节元素（雨夜、霓虹灯、路人）。
*   **4. 风格/媒介 (Style/Medium)**:
    *   **要素**: 决定了画面的“质感”。
    *   **分类**: 摄影类（纪实、电影感、专业汽车摄影）、绘画类（油画、水墨、二次元）、艺术流派（赛博朋克、超现实主义）、特定艺术家/导演风格（宫崎骏、韦斯安德森）。
*   **5. 光影/色彩 (Lighting/Color)**:
    *   **要素**: 氛围的关键。柔光/硬光、逆光/侧光、冷色调/暖色调、低饱和度。
*   **6. 构图/镜头 (Composition/Camera)**:
    *   **要素**: 决定了观众的视角。
    *   **景别**: 特写 (close-up)、中景 (medium shot)、全景 (full shot)、远景 (long shot)。
    *   **角度**: 俯拍 (high-angle)、仰拍 (low-angle)、平视。
*   **7. 质量/技术参数 (Quality/Tech Specs)**:
    *   **要素**: 通用的画质增强词。
    *   **常用词**: 8K, 超高清, 细节丰富, 锐利焦点, 专业摄影, 高清渲染。

---

#### **第三层：特定模态的增强模块 (Modality-Specific Modules)**

##### **模块A：图生视频 (Image-to-Video)**

当用户上传图片并希望其动起来时，提示词的重心从“描述画面”转向“描述变化”。

*   **核心规则**: **不要重复静态描述**，只描述**“运动过程”**和**“镜头变化”**。
*   **关键要素**:
    1.  **主体动作**: “缓慢转身微笑”、“微风吹起头发”、“手部搅拌咖啡”。
    2.  **镜头运动 (运镜)**: “镜头缓慢推近 (dolly in)”、“横移摇臂”、“从远景切到特写”。
    3.  **多镜头叙事 (Multi-shot Storytelling)**: 这是**通义万相2.6的独有高级功能**，需要特殊语法。
        *   **语法**: `镜头一 (时间戳): 景别 + 动作 + 运镜。 镜头二 (时间戳): ...`
        *   **示例**: `镜头一 (0-4秒): 中景, @主角 坐在窗边看雨。 镜头二 (4-8秒): 特写, 手搅拌咖啡。`
    4.  **声音同步**: “轻松背景音乐”、“音效脚步声”、“对话: ‘太棒了!’ (活力男声)”。
    5.  **角色锁定 (Character Consistency)**: 也是**通义万相2.6的独有高级功能**，通过上传参考视频，并在提示词中使用`@角色名`（如`@主角`）来保持人物的高度一致性。

##### **模块B：高级控制技巧 (Advanced Controls)**

*   **负向提示词 (Negative Prompts)**: 告诉AI**不要**画什么。
    *   **常用包**: `低质量, 模糊, 畸形, 多余肢体, 水印, 文字`。
*   **权重控制 (Weighting)**: 告诉AI什么更重要。
    *   **语法**: `(关键词:1.5)` (加强) 或 `[关键词]` (减弱)。
*   **风格混合 (Style Mixing)**:
    *   **语法**: `主体 in the style of [艺术家A] mixed with [艺术家B]`。
*   **一致性控制 (Consistency)**:
    *   **角色设定表**: 在多张图或多个视频片段中，使用固定的核心描述来定义一个角色。
    *   **种子值 (Seed)**: 使用相同的seed值可以生成风格和构图高度相似的系列图。

---

#### **第四层：后端处理逻辑框架 (Backend Processing Logic)**

根据以上总结，您的后端 "antigravity" 可以设计如下规则来重组前端输入：

1.  **输入解析 (Input Parsing)**:
    *   接收用户的自然语言输入，例如：“一个女孩在雨夜的东京街头跳舞，要电影感”。

2.  **核心要素提取与分类 (Component Extraction)**:
    *   利用NLP或关键词匹配，将用户输入拆解并归入**通用结构公式**的七个分类中。
    *   `主体`: 一个女孩
    *   `动作`: 跳舞
    *   `环境`: 雨夜的东京街头
    *   `风格`: 电影感

3.  **关键词扩展与精确化 (Keyword Expansion & Refinement)**:
    *   这是系统的“翻译官”核心。根据提取的模糊词，从预设的“翻译词典”（基于文档中的知识库）中匹配更具体、专业的关键词。
    *   `女孩` -> (可默认或让用户选) `一个20岁左右的亚洲女性, 短发`
    *   `雨夜的东京街头` -> `夜晚的东京街头, 小雨, 潮湿的石板路反射着霓虹灯光, 远处模糊的人群和车辆`
    *   `电影感` -> `电影级光影, 宽银幕比例16:9, 浅景深, 冷色调`
    *   `跳舞` -> (可细化) `在雨中进行充满活力的街舞动作`

4.  **结构化组装 (Structural Assembly)**:
    *   将扩展后的关键词按照**通用结构公式**的顺序重新排列组合，形成一个基础的、高质量的提示词。

5.  **模态适配与语法注入 (Modality Adaptation)**:
    *   **判断生成类型**: 是文生图还是图生视频？
    *   **如果是图生视频**:
        *   从用户输入中寻找**动态词汇**（如“跳舞”、“转头”）。
        *   如果用户输入了镜头指令（如“拉近镜头”），则添加运镜描述 `缓慢推近运镜`。
        *   如果检测到`@角色名`或多镜头格式（如`镜头一`），则启用通义万相的高级模式。
        *   自动添加音频建议，如 `嘻哈背景音乐, 雨声音效`。

6.  **添加通用优化与收尾 (General Optimization & Finalization)**:
    *   在提示词末尾自动追加**质量技术参数**：`8K, 超高清, 细节丰富, 专业摄影`。
    *   自动附加一个标准的**负向提示词** `low quality, blurry, worst quality`。

**最终产出示例**:
`一个20岁左右的亚洲短发女性, 在雨中进行充满活力的街舞动作, 夜晚的东京街头, 潮湿的石板路反射着霓虹灯光, 远处模糊的人群和车辆, 电影感风格, 电影级光影, 宽银幕比例16:9, 浅景深, 冷色调, 中景镜头, 8K, 超高清, 细节丰富, 专业摄影 --neg low quality, blurry, worst quality`

---

我已经将您提供的所有文档融合成了一个清晰、可执行的知识体系和后端处理逻辑。现在，您可以开始对我提问进行验证了。请随时提出任何问题，以确保我的理解与您的需求完全一致。